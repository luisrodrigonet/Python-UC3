## 11.01.03 : Organizando os Templates do Django

Um jeito pr√°tico para se ter um c√≥digo limpo e f√°cil de manter √© **organizar seus templates**. Este material demonstrar√°, passo a passo, como fazer isso, mesmo que  nunca tenha ouvido falar em "separar conte√∫do de templates" antes.

### :one: Por que organizar templates?

Imagine que voc√™ tem uma loja virtual e precisa que o **cabe√ßalho** (com o logo da loja e os links de navega√ß√£o) e o **rodap√©** (com informa√ß√µes de contato e direitos autorais) apare√ßam em *todas* as p√°ginas do seu site. 

Se voc√™ copiar e colar o c√≥digo do cabe√ßalho e do rodap√© em cada um dos seus templates (p√°gina inicial, p√°gina de produtos, p√°gina de contato, etc.), o que acontece se voc√™ precisar mudar o n√∫mero de telefone no rodap√©? Voc√™ teria que alterar em *todas* as p√°ginas\! Isso √© ineficiente e propenso a erros.

**Organizar templates significa criar blocos de c√≥digo reutiliz√°veis**. Assim, voc√™ define o cabe√ßalho e o rodap√© uma √∫nica vez, e eles **s√£o "herdados"** por todas as outras p√°ginas. As vantagens s√£o claras:

  * **Reutiliza√ß√£o de c√≥digo:** Escreva uma vez, use em muitos lugares.
  * **Manuten√ß√£o f√°cil:** Mude em um lugar, atualize em todos.
  * **Organiza√ß√£o:** Seu projeto fica mais limpo e f√°cil de entender.
  * **Colabora√ß√£o:** Facilita o trabalho em equipe, j√° que cada um pode focar em uma parte espec√≠fica.

### :two: Estrutura de Pastas de Templates

Para o Django encontrar seus templates, precisamos criar uma estrutura de pastas espec√≠fica. Em um projeto Django, o mais comum √© ter uma pasta **`templates`** na raiz do seu projeto (**`core`**, no seu caso) e, dentro dela, subpastas para cada aplica√ß√£o.

Vamos criar essa estrutura:

```
core/
‚îú‚îÄ‚îÄ core/
‚îú‚îÄ‚îÄ produtos/
‚îÇ   ‚îî‚îÄ‚îÄ templates/
‚îÇ       ‚îî‚îÄ‚îÄ produtos/
‚îÇ           ‚îî‚îÄ‚îÄ (seus templates de produtos aqui)
‚îú‚îÄ‚îÄ site_loja/
‚îÇ   ‚îî‚îÄ‚îÄ templates/
‚îÇ       ‚îî‚îÄ‚îÄ site_loja/
‚îÇ           ‚îî‚îÄ‚îÄ (seus templates do site aqui)
‚îú‚îÄ‚îÄ templates/  <-- CRIE ESTA PASTA
‚îÇ   ‚îú‚îÄ‚îÄ base.html  <-- CRIE ESTE ARQUIVO
‚îÇ   ‚îú‚îÄ‚îÄ includes/  <-- CRIE ESTA PASTA
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ header.html  <-- CRIE ESTE ARQUIVO
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ footer.html  <-- CRIE ESTE ARQUIVO
‚îú‚îÄ‚îÄ manage.py
‚îî‚îÄ‚îÄ (outros arquivos e pastas)
```

**Explica√ß√£o da estrutura:**

  * **`core/templates/`**: 
      - Esta √© a pasta principal para templates que ser√£o **compartilhados** entre todas as suas aplica√ß√µes. 
      - √â aqui que colocaremos o template **base** do seu site e os "includes" (partes que se repetem, como cabe√ßalho e rodap√©).
      
  * **`produtos/templates/produtos/`**: 
    - Esta pasta conter√° os templates espec√≠ficos da sua aplica√ß√£o `produtos`.
    
  * **`site_loja/templates/site_loja/`**: 
      - Similarmente, esta pasta conter√° os templates espec√≠ficos da sua aplica√ß√£o `site_loja`.

### :three: Configurando o Django para Encontrar Seus Templates

Agora que criamos as pastas, precisamos avisar o Django onde elas est√£o. Abra o arquivo **`core/settings.py`** (o arquivo de configura√ß√µes principal do seu projeto) e encontre a se√ß√£o **`TEMPLATES`**.

Dentro do dicion√°rio **`DIRS`**, adicione o caminho para a sua pasta **`core/templates/`**. Dever√° ficar assim:

```python
# core/settings.py

TEMPLATES = [
    {
        'BACKEND': 'django.template.backends.django.DjangoTemplates',
        'DIRS': [BASE_DIR / 'templates'], # <-- Adicione esta linha
        'APP_DIRS': True,
        'OPTIONS': {
            'context_processors': [
                'django.template.context_processors.debug',
                'django.template.context_processors.request',
                'django.contrib.auth.context_processors.auth',
                'django.contrib.messages.context_processors.messages',
            ],
        },
    },
]
```

üß∞ **O que fizemos aqui?**

  * `BASE_DIR`: 
      - √â uma vari√°vel que aponta para a raiz do seu projeto (a pasta `core/` onde `manage.py` est√°).
        
  * **`BASE_DIR / 'templates'`**: 
      - Isso diz ao Django para procurar templates na pasta `templates` que est√° na raiz do seu projeto.
      
  * **`'APP_DIRS': True`**: 
      - Esta configura√ß√£o j√° est√° ativada por padr√£o e diz ao Django para tamb√©m procurar templates dentro das pastas `templates` de cada aplica√ß√£o (por exemplo, `produtos/templates/` e `site_loja/templates/`).

Com essa configura√ß√£o, o Django saber√° onde buscar seus **templates**, tanto os compartilhados quanto os espec√≠ficos de cada aplica√ß√£o.



### :four: Criando o Template Base (`base.html`)

O arquivo **`base.html`** ser√° o esqueleto do seu site. Ele conter√° o c√≥digo **HTML** comum a todas as p√°ginas, como a estrutura b√°sica, links para CSS do **Bootstrap**, e os blocos onde o conte√∫do espec√≠fico de cada p√°gina ser√° inserido.

Abra o arquivo **`core/templates/base.html`** e adicione o seguinte c√≥digo:

```html
{% load static %}
<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Minha Loja Online{% endblock %}</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
</head>
<body>
    {% include 'includes/header.html' %}

    <main class="container mt-4">
        {% block content %}
        {% endblock %}
    </main>

    {% include 'includes/footer.html' %}

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    {% block extra_js %}
    {% endblock %}
</body>
</html>
```

üß∞ **Vamos entender o que cada parte significa:**

  * **`{% load static %}`**: 
      - Esta linha √© essencial para o Django encontrar seus arquivos est√°ticos (CSS, JavaScript, imagens). 
      - Certifique-se de que voc√™ configurou `STATIC_URL` e `STATICFILES_DIRS` em `settings.py` e rodou `python manage.py collectstatic` se estiver em produ√ß√£o. 
      - Para fins de desenvolvimento, o Django j√° consegue servir arquivos est√°ticos automaticamente.
      
  * **`<title>{% block title %}Minha Loja Online{% endblock %}</title>`**: 
      - Esta √© uma **tag de bloco** do Django. O `block title` define um espa√ßo onde as p√°ginas que herdam deste template podem inserir um t√≠tulo espec√≠fico. 
      - Se a p√°gina que herda n√£o definir um t√≠tulo, "Minha Loja Online" ser√° o padr√£o.
      
  * **`<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" ...>`**: 
      - Inclui o CSS do Bootstrap 5.3 diretamente de um CDN (Content Delivery Network).
      
  * **`<link rel="stylesheet" href="{% static 'css/style.css' %}">`**: 
    - Um exemplo de como incluir um arquivo CSS pr√≥prio, que voc√™ poderia criar em **`static/css/style.css`** na raiz do seu projeto.
    
  * **`{% include 'includes/header.html' %}`**: 
      - Esta √© uma **tag de inclus√£o**. 
      - Ela vai inserir o conte√∫do do arquivo **`header.html`** (que vamos criar a seguir) neste ponto.
      
  * **`{% block content %}{% endblock %}`**: 
    - Este √© o bloco mais importante. 
    - √â aqui que o conte√∫do principal de cada p√°gina individual ser√° renderizado.
    
  * **`{% include 'includes/footer.html' %}`**: 
      - Similar ao cabe√ßalho, inclui o conte√∫do do **`footer.html`**.
      
      
  * **`{% block extra_js %}{% endblock %}`**: 
      - Outro bloco para permitir que p√°ginas espec√≠ficas adicionem seus pr√≥prios scripts JavaScript.



### :five: Criando os Arquivos de Inclus√£o (`header.html` e `footer.html`)

Agora, vamos criar os arquivos **`header.html`** e **`footer.html`** dentro da pasta **`core/templates/includes/`**.

#### üìÅ **`core/templates/includes/header.html`**

```html
<header class="bg-dark text-white py-3">
    <div class="container d-flex justify-content-between align-items-center">
        <a href="/" class="text-white text-decoration-none h4 mb-0">Minha Loja</a>
        <nav>
            <ul class="nav">
                <li class="nav-item"><a href="/" class="nav-link text-white">In√≠cio</a></li>
                <li class="nav-item"><a href="/produtos/" class="nav-link text-white">Produtos</a></li>
                <li class="nav-item"><a href="/contato/" class="nav-link text-white">Contato</a></li>
                </ul>
        </nav>
    </div>
</header>
```

#### üìÅ **`core/templates/includes/footer.html`**

```html
<footer class="bg-dark text-white py-4 mt-5">
    <div class="container text-center">
        <p>&copy; 2025 Minha Loja Online. Todos os direitos reservados.</p>
        <ul class="list-inline">
            <li class="list-inline-item"><a href="#" class="text-white text-decoration-none">Pol√≠tica de Privacidade</a></li>
            <li class="list-inline-item"><a href="#" class="text-white text-decoration-none">Termos de Servi√ßo</a></li>
        </ul>
    </div>
</footer>
```

### :six: Adaptando os Templates das Aplica√ß√µes (**`site_loja`** e **`produtos`**)

Agora que temos nosso template base e os includes, vamos modificar os templates das suas aplica√ß√µes para que eles herdem do **`base.html`**.

Vamos supor que voc√™ tenha um template chamado **`home.html`** em **`site_loja/templates/site_loja/`** e um template **`lista_produtos.html`** em **`produtos/templates/produtos/`**.

#### üìÅ Exemplo: **`site_loja/templates/site_loja/home.html`**

Modifique seu **`home.html`** para algo como isto:

```html
{% extends 'base.html' %}

{% block title %}P√°gina Inicial - Minha Loja{% endblock %}

{% block content %}
<div class="p-5 mb-4 bg-light rounded-3">
    <div class="container-fluid py-5">
        <h1 class="display-5 fw-bold">Bem-vindo(a) √† Nossa Loja!</h1>
        <p class="col-md-8 fs-4">Descubra os melhores produtos com os melhores pre√ßos. Qualidade e variedade para voc√™!</p>
        <a href="/produtos/" class="btn btn-primary btn-lg" type="button">Ver Produtos</a>
    </div>
</div>

<h2>Produtos em Destaque</h2>
<div class="row">
    <div class="col-md-4">
        <div class="card mb-4 shadow-sm">
            <img src="https://via.placeholder.com/300x200" class="card-img-top" alt="Produto 1">
            <div class="card-body">
                <h5 class="card-title">Nome do Produto 1</h5>
                <p class="card-text">Descri√ß√£o breve do produto 1.</p>
                <div class="d-flex justify-content-between align-items-center">
                    <div class="btn-group">
                        <button type="button" class="btn btn-sm btn-outline-secondary">Ver Detalhes</button>
                    </div>
                    <small class="text-muted">R$ 99,90</small>
                </div>
            </div>
        </div>
    </div>
    <div class="col-md-4">
        <div class="card mb-4 shadow-sm">
            <img src="https://via.placeholder.com/300x200" class="card-img-top" alt="Produto 2">
            <div class="card-body">
                <h5 class="card-title">Nome do Produto 2</h5>
                <p class="card-text">Descri√ß√£o breve do produto 2.</p>
                <div class="d-flex justify-content-between align-items-center">
                    <div class="btn-group">
                        <button type="button" class="btn btn-sm btn-outline-secondary">Ver Detalhes</button>
                    </div>
                    <small class="text-muted">R$ 149,90</small>
                </div>
            </div>
        </div>
    </div>
    <div class="col-md-4">
        <div class="card mb-4 shadow-sm">
            <img src="https://via.placeholder.com/300x200" class="card-img-top" alt="Produto 3">
            <div class="card-body">
                <h5 class="card-title">Nome do Produto 3</h5>
                <p class="card-text">Descri√ß√£o breve do produto 3.</p>
                <div class="d-flex justify-content-between align-items-center">
                    <div class="btn-group">
                        <button type="button" class="btn btn-sm btn-outline-secondary">Ver Detalhes</button>
                    </div> 
                    <small class="text-muted">R$ 79,90</small>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
```

**Principais mudan√ßas:**

  * **`{% extends 'base.html' %}`**: 
      - Esta √© a linha m√°gica\! Ela diz ao Django que este template `home.html` vai **herdar** tudo o que est√° em `base.html`.
      
  * **`{% block title %}P√°gina Inicial - Minha Loja{% endblock %}`**:
      - Aqui, estamos sobrescrevendo o bloco `title` definido em `base.html` para dar um t√≠tulo espec√≠fico a esta p√°gina.
      
  * **`{% block content %}`...`{% endblock %}`**: 
      - Todo o conte√∫do espec√≠fico da sua p√°gina inicial deve ir dentro deste bloco. 
      - O que estiver fora desses blocos ser√° ignorado, pois o Django s√≥ se importa com o que est√° nos blocos definidos no template pai.

#### üìÅ Exemplo: **`produtos/templates/produtos/lista_produtos.html`**

```html
{% extends 'base.html' %}

{% block title %}Nossos Produtos - Minha Loja{% endblock %}

{% block content %}
<h1 class="mb-4">Todos os Nossos Produtos</h1>

<div class="row">
    <div class="col-md-4 mb-4">
        <div class="card shadow-sm">
            <img src="https://via.placeholder.com/300x200" class="card-img-top" alt="Produto A">
            <div class="card-body">
                <h5 class="card-title">Produto A</h5>
                <p class="card-text">Uma breve descri√ß√£o do Produto A.</p>
                <div class="d-flex justify-content-between align-items-center">
                    <div class="btn-group">
                        <button type="button" class="btn btn-sm btn-outline-secondary">Detalhes</button>
                    </div>
                    <small class="text-muted">R$ 120,00</small>
                </div>
            </div>
        </div>
    </div>
    <div class="col-md-4 mb-4">
        <div class="card shadow-sm">
            <img src="https://via.placeholder.com/300x200" class="card-img-top" alt="Produto B">
            <div class="card-body">
                <h5 class="card-title">Produto B</h5>
                <p class="card-text">Uma breve descri√ß√£o do Produto B.</p>
                <div class="d-flex justify-content-between align-items-center">
                    <div class="btn-group">
                        <button type="button" class="btn btn-sm btn-outline-secondary">Detalhes</button>
                    </div>
                    <small class="text-muted">R$ 85,50</small>
                </div>
            </div>
        </div>
    </div>
    </div>
{% endblock %}
```

A l√≥gica √© a mesma: estender **`base.html`** e preencher os blocos **`title`** e **`content`**.

### :seven: Dicas Adicionais para Organiza√ß√£o de Templates

  * **Subpastas em `includes/`:** 
      - Se seus "includes" ficarem muito numerosos, voc√™ pode criar subpastas dentro de `core/templates/includes/` para organiz√°-los melhor (ex: `includes/navbars/`, `includes/forms/`).
      
  * **Context Processors:** 
      - Para dados que precisam estar dispon√≠veis em *todos* ou na maioria dos seus templates (como o nome da loja, categorias de produtos globais), considere usar **context processors**. 
      - Eles injetam vari√°veis no contexto de todos os templates, evitando que voc√™ precise pass√°-las manualmente em cada view.
      
  * **Tags e Filtros Customizados:** 
      - Para l√≥gicas de apresenta√ß√£o mais complexas que se repetem, voc√™ pode criar suas pr√≥prias **tags e filtros de template customizados** em suas aplica√ß√µes.
      
  * **Static Files:** 
      - N√£o se esque√ßa de configurar a forma como o Django lida com arquivos est√°ticos (CSS, JS, imagens). 
      - Em `settings.py`, voc√™ deve ter `STATIC_URL` definido. Para arquivos est√°ticos espec√≠ficos de uma aplica√ß√£o, coloque-os em `sua_app/static/sua_app/`. 
      - Para arquivos est√°ticos globais do projeto, voc√™ pode criar uma pasta `static/` na raiz do projeto e adicionar seu caminho a `STATICFILES_DIRS` em `settings.py`.

